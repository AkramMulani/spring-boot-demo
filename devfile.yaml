schemaVersion: 2.2.2
metadata:
  name: workspace-devfile-sample2
  version: 0.0.1
  description: A sample web service template.
  projectType: Java
  language: Java
  provider: GitHub
  tags: [ 'Java', 'Jar' ]
  architectures: [ 'amd64' ]
  displayName: Simple Web Service
  icon: https://github.com/AkramMulani/spring-boot-demo/tree/test/assets/spring_icon.png
components:
  - name: web
    container:
      endpoints:
        - name: http
          targetPort: 8080
      image: quay.io/devfile/universal-developer-image:latest
commands:
  - id: install-maven
    exec:
      commandLine: |
        apt-get update && apt-get install -y maven
      component: web
      group:
        kind: build
        isDefault: true
  - id: build-project
    exec:
      commandLine: mvn clean install
      component: web
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: build
        isDefault: true
  - id: run-project
    exec:
      commandLine: mvn spring-boot:run
      component: web
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: run
        isDefault: true
  - id: tail-logs
    exec:
      commandLine: |
        tail -f ${PROJECT_SOURCE}/file.log
      component: web
      group:
        kind: debug
        isDefault: true
events:
  preStart:
    - build-project
    - run-project
