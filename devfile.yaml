schemaVersion: 2.2.2
metadata:
  name: devfile-sample2
  version: 0.0.1
  description: A sample web service template.
  projectType: Java
  language: Java
  provider: GitHub
  tags:
    - Java
    - Maven
    - SpringBoot
  architectures: [ 'amd64' ]
  displayName: Simple Web Service
  icon: https://github.com/AkramMulani/spring-boot-demo/tree/test/assets/spring_icon.png
projects:
  - name: spring-boot-demo
    git:
      remotes:
        origin: https://github.com/AkramMulani/spring-boot-demo.git
components:
  - name: runner
    attributes:
      container-overrides:
        securityContext:
          runAsUser: 1001
          allowPrivilegeEscalation: false
          runAsNonRoot: true
          capabilities:
            drop: ["ALL"]
          seccompProfile:
            type: "RuntimeDefault"
    container:
      image: quay.io/devfile/universal-developer-image:ubi8-latest
      command:
        - RUN apk add --no-cache openjdk8 maven # Install OpenJDK and Maven
        - mvn clean install
        - mvn spring-boot:run
      mountSources: true
      memoryLimit: "{{memoryLimit}}"
      volumeMounts:
        - name: target
          path: /target
      endpoints:
        - name: http-4200
          protocol: http
          targetPort: 4200
  - name: target
    volume:
      ephemeral: true
      size: 0.2Gi
variables:
  # Memory limit on runner, default: 1Gi
  memoryLimit: 1Gi
